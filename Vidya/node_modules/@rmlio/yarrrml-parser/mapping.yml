prefixes:
  rdfs: http://www.w3.org/2000/01/rdf-schema#
  schema: https://schema.org/
  rdf: http://www.w3.org/1999/02/22-rdf-syntax-ns#
  ai: http://example.com#vocab-
  sh: http://www.w3.org/ns/shacl#
  xsd: http://www.w3.org/2001/XMLSchema#
  dll: http://example.com#delhaize-
  grel: http://users.ugent.be/~bjdmeest/function/grel.ttl#
  vm: http://example.com#vm-
  idlab-fn: http://example.com/idlab/function/
  fm: http://example.com#foodmaker-
  obs: http://example.com#observation-
  ex: http://example.com#
base: http://knows.com/base/
sources:
  FT18:
    access: /data/foodmaker/TxOrder.csv
    referenceFormulation: csv
    delimiter: ','
  FT19:
    access: /data/foodmaker/TxOrderLine.csv
    referenceFormulation: csv
    delimiter: ','
  PT1:
    access: /data/public/covid.csv
    referenceFormulation: csv
    delimiter: ','
  PT3:
    access: /data/public/fm-weather.csv
    referenceFormulation: csv
    delimiter: ','
mappings:
  SalesObservation_1:
    sources:
    - FT18
    s: fm:order-$(DmxKey)
    po:
    - p: schema:seller
      o:
        value: fm:restaurant-$(CenterKey)
        type: iri
    - p: ai:salesObservationDate
      o:
        function: idlab-fn:normalizeDate
        parameters:
        - parameter: idlab-fn:strDate
          value:
            function: grel:string_substring
            parameters:
            - [grel:valueParameter, $(CreateDT)]
            - [grel:param_int_i_from, 0]
            - [grel:param_int_i_opt_to, 8]
        - [idlab-fn:pattern, yyyyMMdd]
        datatype: xsd:date
    - p: a
      o:
        value: ai:SalesObservation
        type: iri
    - p: ai:isTakeAway
      o:
        Function: grel:toLowerCase
        parameters:
        - [grel:valueParameter, $(IsTakeAway)]
        datatype: xsd:boolean
  SalesObservationLine_1:
    sources:
    - FT19
    s: fm:order-$(TxOrder_DmxKey)-line-$(DmxKey)
    po:
    - p: a
      o:
        value: ai:SalesObservationLine
        type: iri
    - p: ai:soldItem
      o:
        value: fm:product-$(ProductKey)
        type: iri
    - p: ai:soldQuantity
      o:
        value: $(Quantity)
        datatype: xsd:decimal
    - p: schema:isPartOf
      o:
        value: fm:order-$(TxOrder_DmxKey)
        type: iri
  CovidObservation_0:
    sources:
    - PT1
    s: obs:covid-$(ds)
    po:
    - p: a
      o:
        value: ai:CovidObservation
        type: iri
    - p: ai:covidObservationDate
      o:
        value: $(ds)
        datatype: xsd:date
    - p: ai:numberOfCovidDeaths
      o:
        value: $(NumDeaths)
        datatype: xsd:integer  
  WeatherObservation_1:
    sources:
    - PT3
    s: obs:weather-$(date)-foodmaker-$(DmxKey)
    po:
    - p: a
      o:
        value: ai:WeatherObservation
        type: iri
    - p: ai:weatherObservationDate
      o:
        value: $(date)
        datatype: xsd:date
    - p: schema:maxTemperature
      o:
        value: $(TMAX)
        datatype: xsd:decimal
    - p: schema:minTemperature
      o:
        value: $(TMIN)
        datatype: xsd:decimal
    - p: ai:precipitationMillimeter
      o:
        value: $(PRCP)
        datatype: xsd:decimal
    - p: schema:location
      o:
        value: fm:restaurant-$(DmxKey)
        type: iri
            
